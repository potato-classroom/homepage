---
title: 無痛學正規表達式 —— Part 1
date: 2020-05-03 18:06:01
tags: [正規式, 基礎]
---

# 前言

網路上有各種正規表達式的教學文章。但我相信大部分的人讀完多數的文章仍然不懂正規式。主要原因是因為正規式本身可以被寫得很複雜，有很多的功能，大多的教學很容易讓人覺得因為正規式複雜而讓人挫敗。

就跟在小學學算數一樣，當學完了基本的加減乘除後，老師會開始教你更難的數學，例如集合、代數等等。當然這些進階的東西是你學習數學所必須的，但我們日常生活中只會用到基本的加減乘除，若一開始就學習那些高級的東西很容易使人挫折。

在這一系列的文章中我只會專注於教你正規表示式的「加減乘除」。

<!-- more -->

# 使用環境

這篇文章中所提到的正規表示式應該能在大多數的程式語言中使用。但這裡主要會使用 JavaScript。有些進階的功能可能無法在某些實作上使用，但這裡不會討論到那些功能。

所有的範例都可以在 [https://regexr.com/](https://regexr.com/) 上試試。這個網站可以讓你測試隨時測試各種正規式。輸入正規式後還會給你一些解釋。

# 基礎中的基礎

正規式是一串「代碼」，或者我們可以說是「格式 (Pattern)」，可以用來從一段字串當中根據制定的格式來截取出其中的一部分。

來看看下面的正規表示式：

```jsx
/hey!/
```

這個例子當中只有一個字，「hey!」。你可以用 JavaScript 的 `String.prototype.match` 方法來試試：

```jsx
const result = "hey! how do you do today?".match(/hey!/)

console.log(result)
```

你會看到輸出的結果是一個陣列：`['hey!']`。

這個例子是一個非常基礎的正規表達式，只是找出你打出來的字而已。接下來你可以試試看把「hey!」改成其他字串，例如「how」或是「you」，然後看看輸出結果是什麼。

# 符號

在上一個例子當中，我們用了正規式「`/hey!/`」來找到一個單子。如果你試了「`/today?/`」，你會發現結果跟你想的有點不一樣：

```jsx
const result = "hey! how do you do today?".match(/today?/)

console.log(result) // ['today']
```

問號沒有被包含在 `result` 裡面！為什麼會這樣呢？原來，在正規表達式中，有些符號有特別的意思。就像 JavaScript 跟大部分的程式語言中，如果要在字串裡包含反斜線（`\`）則需要輸入兩次 `\\`。因為反斜線可以通過跟其他的字元組合而變成一些符號，例如換行字元 `\n` 或是 Tab 字元 `\t`。問號 `?` 在正規式裡也是類似的概念。

接下來讓我們來看看各種特殊字元！

## 問號「?」

問號「?」非常簡單，就只是用來找出前面的字元出現或沒出現而已。我相信你看到下面這個例子就會懂了：

```jsx
console.log("books".match(/books?/)) // ["books"]

console.log("book".match(/books?/))  // ["book"]
```

（問號還有另一個功能，我們將在這系列下一篇文章中討論。）

## 點「.」

點「.」代表任何的字元 —— 除了換行字元（CR/LF）。

```jsx
const input = "<a href='http://example.com'>"

console.log(input.match(/'./)) // ["'h"]
console.log(input.match(/'../)) // ["'ht"]
console.log(input.match(/'.../)) // ["'htt"]
```

## 加「+」

加號「+」可以找出一個字元出現一次或多次出現。

```jsx
const input = "<a href='http://example.com'>"

// 我們可以把加號跟句點「.」何在一起使用。
console.log(input.match(/'.+/)) // ["'http://example.com'>"]
console.log(input.match(/'.+'/)) // ["'http://example.com'"]
```

## 星號「*」

星號就跟加號（`+`）類似，但星號允許前面的字元沒出現。

```jsx
const input = "<a href='http://example.com'>"

console.log(input.match(/'.+'/)) // ["'http://example.com'"]
console.log(input.match(/'.*'/)) // ["'http://example.com'"] - 輸出結果就跟加號 + 一樣！
```

來看看另一個例子：

```jsx
const input2 = "<a href=''>"

console.log(input.match(/'.+'/)) // [] - 什麼都沒有！
console.log(input.match(/'.*'/)) // ["''"]
```

## 方括號「[ ]」

方括號代表要讓程式找出括號中的任一字元。

```jsx
const input = "我的電話號碼是: 0912345678"

console.log(input.match(/[0123456789]+/)) // ["0912345678"]
```

很有用，但在現實中我們可能不會這樣寫電話號碼。通常會加上減號（`-`）來讓它更好讀。國際電話的話還會有國碼，前面會多一個 `+`。來把這兩個符號加進正規式當中！

```jsx
const input = "我的電話號碼是: +886-912-345-678"

console.log(input.match(/[0123456789+-]+/)) // ["+886-912-345-678"]
```

你可能會覺得很奇怪，我們剛才提過問號「?」的作用了。`9?` 是不是表示要找到重複好幾個的 9 呢？並不會。因為我們把問號放在方括號裡面了。方括號只會搜尋單一字元，而重複多個的 9 代表必須要找多個字元，所以在方括號裡面不需要在 + 與 * 前面加上跳脫字元。

另外，除了直接寫出所有的數字（`0123456789`），也可以用一個減號來代表一個範圍的字元：
```jsx
const input = "我的電話號碼是: +886-912-345-678"

console.log(input.match(/[0-9+-]+/)) // ["+886-123-456-789"]
```

這個例子看起來也有點奇怪。如果減號在方括號裡面代表特殊意思，那第二個減號呢？  
減號只有在他的兩邊有字元的時候才代表一個「範圍」（例如 `0-9` 或 `a-z`）。而第二個減號在方括號的結尾，所以他就代表字面上的「`-`」。

關於方括號，還有一個東西要學，就是 —— `^` 符號 (Caret)！

如果在方括號一開始加上 `^`，就會找出所有 **除了** 方括號內的字元以外的所有字元。

來看看下面這個使用句點「.」的例子：

```jsx
const input = "<a href='http://example.com' target='_blank'>連結</a>"

console.log(input.match(/href='.+'/))
// ["href='http://example.com' target='_blank'"]
// 好像不是我們想要的結果……我們只想要網址的部分……

// 可以用下面這個寫法：
console.log(input.match(/href='[^']+'/)) // ["href='http://example.com'"]
```

`[^']` 這個部分表示找出 **除了單引號 (')** 外所有的字元。所以當找到 `'` 後就會停止。

## 括號「( )」

括號代表分組出一小部分的格式。

有時候我們只需要結果中的其中一部分：

```jsx
const input = "<a href='http://example.com' target='_blank'>連結</a>"

console.log(input.match(/href='[^']+'/)) // ["href='http://example.com'"]
```

如果我們只想要抓出單引號中的網址，我們可以加上括號：

```jsx
console.log(input.match(/href='([^']+)'/))
// ["href='http://example.com'", "http://example.com"]
```

輸出的陣列包含了兩個字串。第一個字串代表的正規式找到的整個範圍。而第二個則代表分組的內容。

# 接下來呢？

到目前為止你所學的正規式已經足夠應付你的日常所需了！上面提到的這些符號對於大多數的狀況都已經足夠了。而且其中的例子還包含了如何截取出 HTML 的屬性 (Attribute)，以及找出電話號碼。

下一篇文章我會講解有關錨點（Anchor）、貪多（Greedy）、字元類（Character Classes）、以及旗標（Flags）。

如果有任何問題，歡迎留言！
